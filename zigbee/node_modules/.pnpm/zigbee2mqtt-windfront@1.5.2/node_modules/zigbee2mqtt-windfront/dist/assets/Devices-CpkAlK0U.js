import{r as o,a as b,ai as h,b as C,W as j,j as e,B as S,S as D,F as w,y as k}from"./index-B9KSRkAy.js";import{g as y,R as M,A as F}from"./RecallRemove-ByrNeUbK.js";import{D as N}from"./DevicePicker-BPQGOPp-.js";import{E as R}from"./EndpointPicker-wR5nrVyy.js";import{D as E}from"./DashboardFeatureWrapper-BV-EJkYu.js";import{D as A}from"./DeviceCard-BibgHF2R.js";import"./envs-DFlyG_dH.js";import"./Feature-DRiBEd30.js";import"./DisplayValue-DKwqD83w.js";import"./_createCompounder-Db7SjIIq.js";import"./InputField-D8fYIAZ2.js";import"./SelectField-CwoktH0d.js";import"./LastSeen-kmLjgf_4.js";import"./format-CsVfcRLB.js";import"./Lqi-BZ7lW9bx.js";import"./PowerSource-DgbKMgpx.js";import"./snakeCase-BsE9z82R.js";import"./DeviceImage-XiUg0NFS.js";import"./index-DajxErfA.js";const G=o.memo(n=>{const[i,m]=o.useState(""),[a,g]=o.useState(""),{group:c}=n,d=b(s=>s.devices),l=o.useMemo(()=>h(d.find(s=>s.ieee_address===a)),[a,d]),{t:r}=C(["groups","zigbee"]),{sendMessage:u}=o.useContext(j),t=o.useCallback(s=>{g(s.ieee_address);const p=h(s);m(p.values().next().value)},[]);return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-lg font-semibold",children:r("add_to_group_header")}),e.jsxs("div",{className:"mb-3",children:[e.jsx(N,{label:r("zigbee:device"),value:a,devices:d,onChange:t}),e.jsx(R,{label:r("zigbee:endpoint"),values:l,value:i,onChange:s=>m(s)})]}),e.jsx(S,{onClick:async()=>await u("bridge/request/group/members/add",{group:c.id.toString(),endpoint:i,device:a}),className:"btn btn-primary",children:r("add_to_group")})]})}),I=o.memo(n=>{const{removeDeviceFromGroup:i,groupMember:m,device:a,deviceState:g,lastSeenConfig:c,setDeviceState:d,getDeviceState:l}=n,{endpoint:r}=m,{t:u}=C(["groups","common"]),t=o.useMemo(()=>{const v=[];for(const _ of a.definition?.exposes??[]){const x=y(_);if(x&&(v.push(x),v.length===10))break}return v},[a]),s=o.useCallback(async v=>await d(a.ieee_address,v),[a.ieee_address,d]),p=o.useCallback(async v=>await l(a.ieee_address,v),[a.ieee_address,l]),f=o.useCallback(async()=>await i(a.ieee_address,r),[a.ieee_address,r,i]);return e.jsx(A,{features:t,device:a,endpoint:r,deviceState:g,onChange:s,onRead:p,featureWrapperClass:E,lastSeenConfig:c,children:e.jsx(D,{onClick:f,className:"btn btn-square btn-outline btn-error btn-sm",title:u("remove_from_group"),modalDescription:u("common:dialog_confirmation_prompt"),modalCancelLabel:u("common:cancel"),children:e.jsx(w,{icon:k})})})}),W=o.memo(n=>{const{group:i}=n,m=b(t=>t.devices),a=b(t=>t.deviceStates),g=b(t=>t.bridgeInfo.config.advanced.last_seen),{sendMessage:c}=o.useContext(j),d=o.useCallback(async(t,s)=>await c("bridge/request/group/members/remove",{device:t,endpoint:s,group:i.id.toString()}),[c,i.id]),l=o.useCallback(async(t,s)=>{await c(`${t}/set`,s)},[c]),r=o.useCallback(async(t,s)=>{await c(`${t}/get`,s)},[c]),u=o.useMemo(()=>{const t=[];for(const s of i.members){const p=m.find(f=>f.ieee_address===s.ieee_address);p&&t.push(e.jsx("div",{className:"w-[23rem] card bg-base-200 rounded-box shadow-md",children:e.jsx(I,{removeDeviceFromGroup:d,device:p,groupMember:s,deviceState:a[p.friendly_name]??{},lastSeenConfig:g,setDeviceState:l,getDeviceState:r})},`${s.ieee_address}-${s.endpoint}`))}return t},[i,m,g,a,d,l,r]);return e.jsx("div",{className:"flex flex-row flex-wrap justify-center gap-3",children:u})});function te({group:n}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-row flex-wrap justify-evenly gap-4 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(G,{group:n})}),e.jsx("div",{className:"flex-1",children:e.jsx(M,{target:n,deviceState:{}})}),e.jsx("div",{className:"flex-1",children:e.jsx(F,{target:n,deviceState:{}})})]}),e.jsx(W,{group:n})]})}export{te as default};

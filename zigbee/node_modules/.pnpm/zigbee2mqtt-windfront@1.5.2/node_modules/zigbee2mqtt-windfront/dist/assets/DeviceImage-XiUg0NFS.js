import{j as a,F as l,a2 as x,r as d,b as w,aq as b,as as O,c8 as S,c9 as P,M as N,ca as _}from"./index-B9KSRkAy.js";import{g as D,a as y}from"./index-DajxErfA.js";function I({error:r,children:e}){return r?a.jsx(l,{icon:x,size:"3x",className:"text-error",title:"Missing image"}):e}function p(r){"@babel/helpers - typeof";return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(r)}function E(r,e){if(p(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,e);if(p(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function A(r){var e=E(r,"string");return p(e)=="symbol"?e:e+""}function L(r,e,t){return(e=A(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var $=function(r){var e=r.crossOrigin,t=e===void 0?"":e;return function(i){return new Promise(function(n,o){var c=new Image;t&&(c.crossOrigin=t),c.onload=function(){c.decode?c.decode().then(n).catch(o):n()},c.onerror=o,c.src=i})}};function j(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,i)}return t}function g(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?j(Object(t),!0).forEach(function(i){L(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}var F=function(e){return e.filter(function(t){return t})},M=function(e){return Array.isArray(e)?e:[e]},u={},T=function(e,t){var i=!1;return new Promise(function(n,o){var c=function(m){return t(m).then(function(){i=!0,n(m)})};e.reduce(function(f,m){return f.catch(function(){if(!i)return c(m)})},c(e.shift())).catch(o)})};function q(r){var e=r.srcList,t=r.imgPromise,i=t===void 0?$({}):t,n=r.useSuspense,o=n===void 0?!0:n,c=d.useState(!1),f=c[1],m=F(M(e)),s=m.join("");if(u[s]||(u[s]={promise:T(m,i),cache:"pending",error:null}),u[s].cache==="resolved")return{src:u[s].src,isLoading:!1,error:null};if(u[s].cache==="rejected"){if(o)throw u[s].error;return{isLoading:!1,error:u[s].error,src:void 0}}if(u[s].promise.then(function(v){u[s]=g(g({},u[s]),{},{cache:"resolved",src:v}),o||f(s)}).catch(function(v){u[s]=g(g({},u[s]),{},{cache:"rejected",error:v}),o||f(s)}),o)throw u[s].promise;return{isLoading:!0,src:void 0,error:null}}const h=d.memo(({device:r={},className:e})=>{const t=r.definition?.icon,i=D(r),n=[];t&&n.push(t),i&&n.push(i),i!==y&&n.push(y);const{src:o}=q({srcList:n});return a.jsx("img",{alt:r.ieee_address,crossOrigin:"anonymous",src:o,className:e})}),k=d.memo(r=>{const{t:e}=w("zigbee"),{device:t={},disabled:i,otaState:n,className:o,noIndicator:c}=r,f=d.useMemo(()=>t.interview_state===b.InProgress?a.jsx(l,{icon:O,spin:!0,title:e("interviewing"),className:"indicator-item indicator-bottom indicator-end text-info"}):t.interview_state===b.Failed?a.jsx(l,{icon:x,beat:!0,title:e("interview_failed"),className:"indicator-item indicator-bottom indicator-end text-error"}):t.definition?.source==="generated"?a.jsx(l,{icon:S,beat:!0,title:e("unsupported"),className:"indicator-item indicator-bottom indicator-end text-warning"}):t.definition?.source==="external"?a.jsx(l,{icon:P,title:e("unsupported"),className:"indicator-item indicator-bottom indicator-end text-info"}):null,[t.interview_state,t.definition,e]);return a.jsx(d.Suspense,{fallback:a.jsx("img",{alt:t.ieee_address,src:y}),children:a.jsx(I,{children:c?a.jsx(h,{device:t,className:`grid place-items-center${o?` ${o}`:""}`}):a.jsxs("div",{className:"indicator w-full",children:[n==="updating"&&a.jsx(l,{icon:N,spin:!0,title:e("updating_firmware"),className:"indicator-item indicator-top indicator-end text-info"}),f,i&&a.jsx(l,{icon:_,title:e("common:disabled"),className:"indicator-item indicator-middle indicator-center text-error",size:"2xl"}),a.jsx(h,{device:t,className:`grid place-items-center${o?` ${o}`:""}`})]})})})});export{k as D};

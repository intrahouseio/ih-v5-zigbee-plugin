import{ag as le,aW as rr,aX as tr,aY as ar,aZ as nr,l as sr,a_ as or,a$ as cr,b0 as ir,b1 as lr,b2 as ur,aO as ue,b3 as me,b4 as mr,b5 as fr,b6 as hr,b7 as pr,b8 as dr,b9 as xr,ba as fe,bb as br,bc as he,bd as gr,be as _r,bf as L,bg as pe,bh as de,a2 as yr,bi as Cr,bj as vr,bk as jr,bl as Sr,bm as Tr,bn as kr,bo as Er,bp as Nr,bq as Rr,br as Ar,bs as wr,bt as Fr,bu as qr,bv as $r,bw as Ir,bx as Br,by as Mr,bz as Vr,bA as Or,bB as F,aQ as Gr,bC as xe,bD as Ur,bE as Hr,bF as Lr,bG as Pr,bH as Be,bI as zr,bJ as Me,bK as Wr,bL as Dr,bM as Xr,bN as Qr,r as i,j as o,b as w,B as S,F as ie,bO as Yr,ax as Jr,bP as Kr,bQ as Zr,M as et}from"./index-B9KSRkAy.js";import{D as U}from"./DisplayValue-DKwqD83w.js";import{r as Ve,a as Oe,b as rt}from"./_createCompounder-Db7SjIIq.js";var P,be;function tt(){if(be)return P;be=1;function e(a,t,r){var s=-1,n=a.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var u=Array(n);++s<n;)u[s]=a[s+t];return u}return P=e,P}var z,ge;function at(){if(ge)return z;ge=1;var e=tt();function a(t,r,s){var n=t.length;return s=s===void 0?n:s,!r&&s>=n?t:e(t,r,s)}return z=a,z}var W,_e;function Ge(){if(_e)return W;_e=1;var e="\\ud800-\\udfff",a="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",s=a+t+r,n="\\ufe0e\\ufe0f",u="\\u200d",c=RegExp("["+u+e+s+n+"]");function f(l){return c.test(l)}return W=f,W}var D,ye;function nt(){if(ye)return D;ye=1;function e(a){return a.split("")}return D=e,D}var X,Ce;function st(){if(Ce)return X;Ce=1;var e="\\ud800-\\udfff",a="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",s=a+t+r,n="\\ufe0e\\ufe0f",u="["+e+"]",c="["+s+"]",f="\\ud83c[\\udffb-\\udfff]",l="(?:"+c+"|"+f+")",d="[^"+e+"]",h="(?:\\ud83c[\\udde6-\\uddff]){2}",m="[\\ud800-\\udbff][\\udc00-\\udfff]",p="\\u200d",x=l+"?",y="["+n+"]?",j="(?:"+p+"(?:"+[d,h,m].join("|")+")"+y+x+")*",N=y+x+j,b="(?:"+[d+c+"?",c,h,m,u].join("|")+")",g=RegExp(f+"(?="+f+")|"+b+N,"g");function C(E){return E.match(g)||[]}return X=C,X}var Q,ve;function ot(){if(ve)return Q;ve=1;var e=nt(),a=Ge(),t=st();function r(s){return a(s)?t(s):e(s)}return Q=r,Q}var Y,je;function ct(){if(je)return Y;je=1;var e=at(),a=Ge(),t=ot(),r=Ve();function s(n){return function(u){u=r(u);var c=a(u)?t(u):void 0,f=c?c[0]:u.charAt(0),l=c?e(c,1).join(""):u.slice(1);return f[n]()+l}}return Y=s,Y}var J,Se;function Ue(){if(Se)return J;Se=1;var e=ct(),a=e("toUpperCase");return J=a,J}var K,Te;function it(){if(Te)return K;Te=1;var e=Ve(),a=Ue();function t(r){return a(e(r).toLowerCase())}return K=t,K}var Z,ke;function lt(){if(ke)return Z;ke=1;var e=it(),a=Oe(),t=a(function(r,s,n){return s=s.toLowerCase(),r+(n?e(s):s)});return Z=t,Z}var ut=lt();const mt=le(ut);var ee,Ee;function ft(){if(Ee)return ee;Ee=1;var e=Oe(),a=Ue(),t=e(function(r,s,n){return r+(n?" ":"")+a(s)});return ee=t,ee}var ht=ft();const pt=le(ht),dt={battery_low:F,humidity:Or,illuminance:L,pressure:Vr,co2:Mr,voltage:Br,state:Ir,brightness:L,occupancy:$r,presence:qr,current:Fr,power:wr,energy:Ar,frequency:Rr,tamper:Nr,smoke:Er,radiation_dose_per_hour:kr,radioactive_events_per_minute:Tr,power_factor:Sr,mode:jr,sound:vr,position:Cr,alarm:yr,color_xy:de,color_hs:de,color_temp:pe,color_temp_startup:pe,illuminance_lux:L,soil_moisture:_r,water_leak:fe,week:gr,workdays_schedule:he,holidays_schedule:he,away_mode:br,vibration:fe,power_outage_count:xr,action:dr,angle_x:pr,angle_y:hr,angle_z:fr,side:mr,humidity_alarm:me,temperature_alarm:me,approach_distance:ue,distance:ue,trigger_count:ur,level_config:lr,station:ir,effect:cr,linkquality:or,system_mode:sr,gradient:nr,sensitivity:ar,test:tr,flow:rr},xt=(e,a)=>{let t=F;return e==null||(e>=85?(t=Be,a.push("text-success")):e>=65?t=zr:e>=40?t=Me:e>=20?t=Wr:(t=F,a.push("text-error"))),t},bt=(e,a)=>{let t=F;switch(e){case"high":{t=Be,a.push("text-success");break}case"medium":{t=Me;break}case"low":{t=F,a.push("text-error");break}}return t},gt=(e,a,t)=>{let r=xe;return e==null||(a==="°F"&&(e=(e-32)/1.8),e>=30?(r=Ur,t.push("text-error")):e>=25?r=Hr:e>=20?r=Lr:e>=15?r=Pr:e<5&&(r=xe,t.push("text-info"))),r},_t=(e,a,t)=>{let r;const s=[],n={};switch(e){case"battery":{r=xt(a,s);break}case"battery_state":{r=bt(a,s);break}case"battery_low":{a&&s.push("text-error");break}case"device_temperature":case"temperature":case"local_temperature":{r=gt(a,t,s);break}case"humidity":{a!=null&&a>60&&s.push("text-info");break}case"contact":{r=a?Xr:Qr,a||s.push("text-primary");break}case"occupancy":{a&&(s.push("text-warning"),n.beat=!0);break}case"presence":{a&&(s.push("text-warning"),n.beat=!0);break}case"tamper":{a&&(s.push("text-error"),n.beatFade=!0,n.shake=!0);break}case"water_leak":{a&&(s.push("text-primary"),n.beatFade=!0);break}case"vibration":{a&&(s.push("text-primary"),n.shake=!0);break}default:{e.includes("cyclic")&&(r=Dr);break}}return r?[r,s.join(" "),n]:(r=dt[e],r?[r,s.join(" "),n]:[Gr,"opacity-0",{}])},He=e=>`${e.type}-${e.name}-${e.label}-${e.property}-${e.access}-${e.category}-${e.endpoint}`;var v=(e=>(e[e.STATE=1]="STATE",e[e.SET=2]="SET",e[e.GET=4]="GET",e[e.STATE_SET=3]="STATE_SET",e[e.STATE_GET=5]="STATE_GET",e[e.ALL=7]="ALL",e))(v||{});const q=i.memo(({feature:e,deviceValue:a})=>o.jsxs("div",{children:[e.property&&o.jsx("span",{className:"font-bold",children:o.jsx(U,{value:a,name:e.name})}),"unit"in e&&o.jsx("span",{className:"text-xs ms-1",children:e.unit})]})),$=i.memo(e=>o.jsxs("div",{className:"alert alert-warning",role:"alert",children:["Unknown access ",o.jsx("pre",{children:e.feature.access})]})),yt=i.memo(e=>{const{feature:{access:a=v.SET,name:t,property:r,value_off:s,value_on:n},deviceValue:u,onChange:c,minimal:f}=e,{t:l}=w("zigbee"),d=i.useCallback(m=>c({[r]:m}),[r,c]),h=i.useCallback(m=>c({[r]:m.target.checked?n:s}),[n,s,r,c]);if(a&v.SET){const m=u!=null,p=!f||f&&!m;return o.jsxs("div",{children:[p&&o.jsx(S,{className:"btn btn-link",item:s,onClick:d,children:o.jsx(U,{value:s,name:t})}),m?o.jsx("input",{className:"toggle",type:"checkbox",checked:u===n,onChange:h}):o.jsx(ie,{icon:Yr,title:l("unknown")}),p&&o.jsx(S,{className:"btn btn-link",item:n,onClick:d,children:o.jsx(U,{value:n,name:t})})]})}return a&v.STATE?o.jsx(q,{...e}):o.jsx($,{...e})}),R=i.memo(e=>{const{feature:a,onChange:t,parentFeatures:r,onRead:s,device:n,deviceState:u,featureWrapperClass:c,minimal:f,endpointSpecific:l,steps:d}=e,{type:h,property:m}=a,[p,x]=i.useState({}),{t:y}=w(["composite","common"]),j=i.useMemo(()=>Jr({},u,p),[u,p]),N="features"in a&&a.features||[],b=i.useMemo(()=>{if(h==="composite"&&r!==void 0){if(r.length===0)return!0;if(r.length===1){const _=r[0].type;return _!=null&&_!=="composite"&&_!=="list"}}return!1},[h,r]);i.useEffect(()=>{x({})},[n.ieee_address]);const g=i.useCallback(_=>{x({...p,..._}),b||t(h==="composite"&&m?{[m]:{...p,..._}}:_)},[p,h,m,b,t]),C=i.useCallback(()=>{const _={...u,...p};t(m?{[m]:_}:_)},[m,t,p,u]),E=i.useCallback(_=>{s?.(h==="composite"&&m?{[m]:_}:_)},[s,h,m]);return o.jsxs(o.Fragment,{children:[N.map(_=>o.jsx(er,{feature:_,parentFeatures:r??[],device:n,deviceState:j,onChange:g,onRead:E,featureWrapperClass:c,minimal:f,endpointSpecific:l,steps:d?.[_.name]},He(_))),b&&o.jsx("div",{className:"self-end float-right",children:o.jsx(S,{className:`btn btn-primary ${f?"btn-sm":""}`,onClick:C,children:y("common:apply")})})]})}),Ct=i.memo(e=>o.jsx(R,{...e}));var re,Ne;function vt(){if(Ne)return re;Ne=1;function e(a,t,r){return a===a&&(r!==void 0&&(a=a<=r?a:r),t!==void 0&&(a=a>=t?a:t)),a}return re=e,re}var te,Re;function jt(){if(Re)return te;Re=1;var e=/\s/;function a(t){for(var r=t.length;r--&&e.test(t.charAt(r)););return r}return te=a,te}var ae,Ae;function St(){if(Ae)return ae;Ae=1;var e=jt(),a=/^\s+/;function t(r){return r&&r.slice(0,e(r)+1).replace(a,"")}return ae=t,ae}var ne,we;function Tt(){if(we)return ne;we=1;var e=St(),a=Kr(),t=rt(),r=NaN,s=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;function f(l){if(typeof l=="number")return l;if(t(l))return r;if(a(l)){var d=typeof l.valueOf=="function"?l.valueOf():l;l=a(d)?d+"":d}if(typeof l!="string")return l===0?l:+l;l=e(l);var h=n.test(l);return h||u.test(l)?c(l.slice(2),h?2:8):s.test(l)?r:+l}return ne=f,ne}var se,Fe;function kt(){if(Fe)return se;Fe=1;var e=vt(),a=Tt();function t(r,s,n){return n===void 0&&(n=s,s=void 0),n!==void 0&&(n=a(n),n=n===n?n:0),s!==void 0&&(s=a(s),s=s===s?s:0),e(a(r),s,n)}return se=t,se}var Et=kt();const k=le(Et),Nt=[.412453,.35758,.180423,.212671,.71516,.072169,.019334,.119193,.950227],Rt=[3.2404813432005266,-1.5371515162713183,-.49853632616888777,-.9692549499965684,1.8759900014898907,.041555926558292815,.05564663913517715,-.20404133836651123,1.0573110696453443],Le=.42,Pe=.0031308,ze=12.92,H=.055,O=e=>e<=Pe?ze*e:(1+H)*e**Le-H,At=1/Le,wt=O(Pe),Ft=1/ze,oe=e=>e<=wt?e*Ft:((e+H)/(1+H))**At,We=(e,a)=>{const t=[0,0,0];for(let r=0;r<3;r++){t[r]=0;for(let s=0;s<3;s++)t[r]+=a[r*3+s]*e[s]}return t},qe=(e,a,t)=>{const r=[oe(e),oe(a),oe(t)];return We(r,Nt)},qt=(e,a,t)=>{const r=We([e,a,t],Rt);return[O(r[0]),O(r[1]),O(r[2])]},De=(e,a,t)=>{const r=1-e-a;return qt(t/a*e,t,t/a*r)},Xe=(e,a,t=10)=>{let r=1;for(let s=0;s<t;s++){const n=Math.max(...De(e,a,r));r=r/n}return r},I=(e,a,t)=>{if(e/=255,a/=255,t/=255,e<1e-12&&a<1e-12&&t<1e-12){const[c,f,l]=qe(1,1,1),d=c+f+l;return[c/d,f/d,0]}const[r,s,n]=qe(e,a,t),u=r+s+n;return[r/u,s/u,s]},$t=(e,a,t)=>{t===void 0&&(t=Xe(e,a));const[r,s,n]=De(e,a,t);return[k(r*255,0,255),k(s*255,0,255),k(n*255,0,255)]},B=(e,a,t)=>{e/=255,a/=255,t/=255;const r=Math.max(e,a,t),s=r-Math.min(e,a,t),n=s?(r===e?(a-t)/s+(a<t?6:0):r===a?2+(t-e)/s:4+(e-a)/s)*60:0,u=r?s/r*100:0,c=r*100;return[k(n,0,360),k(u,0,100),k(c,0,100)]},It=(e,a,t)=>{a/=100,t/=100;const r=~~(e/60),s=e/60-r,n=t*(1-a),u=t*(1-a*s),c=t*(1-a*(1-s)),f=r%6,l=[t,u,n,n,c,t][f]*255,d=[c,t,t,u,n,n][f]*255,h=[n,n,c,t,t,u][f]*255;return[k(l,0,255),k(d,0,255),k(h,0,255)]},M=(e,a,t)=>{const[r,s,n]=[e,a,t].map(u=>Math.round(u).toString(16).padStart(2,"0"));return`#${r}${s}${n}`},Bt=e=>(e=e.slice(1),Array.from({length:3}).map((a,t)=>Number.parseInt(e.slice(t*2,t*2+2),16))),A=(e,a)=>{switch(a){case"color_xy":{const{x:t=.313,y:r=.329,Y:s=Xe(t,r===0?.329:r)}=e,n=r===0?[255,255,255]:$t(t,r,s);return{color_rgb:n,color_hs:B(...n),color_xy:[t,r,s],hex:M(...n)}}case"color_hs":{const{hue:t=0,saturation:r=0}=e,s=100,n=It(t,r,s);return{color_rgb:n,color_hs:[t,r,s],color_xy:I(...n),hex:M(...n)}}case"color_rgb":{const{r:t=255,g:r=255,b:s=255}=e;return{color_rgb:[t,r,s],color_hs:B(t,r,s),color_xy:I(t,r,s),hex:M(t,r,s)}}case"hex":{const t=e.hex,r=Bt(t);return{color_rgb:r,color_hs:B(...r),color_xy:I(...r),hex:t}}default:{const t=[255,255,255];return{color_rgb:t,color_hs:B(...t),color_xy:I(...t),hex:M(...t)}}}},$e=(e,a)=>{switch(a){case"color_xy":return{x:e.color_xy[0],y:e.color_xy[1]};case"color_hs":return{hue:e.color_hs[0],saturation:e.color_hs[1]};case"color_rgb":return{r:e.color_rgb[0],g:e.color_rgb[1],b:e.color_rgb[2]};case"hex":return{hex:e.hex}}},Qe=e=>`${e[0].toFixed(3)}, ${e[1].toFixed(3)}, ${e[2].toFixed(3)}`,G=e=>`${e[0].toFixed(2)}°, ${e[1].toFixed(2)}%, ${e[2].toFixed(2)}%`,Ye=e=>`${e[0].toFixed(0)}, ${e[1].toFixed(0)}, ${e[2].toFixed(0)}`,Je=e=>e,Ie=e=>({color_xy:Qe(e.color_xy),color_hs:G(e.color_hs),color_rgb:Ye(e.color_rgb),hex:Je(e.hex)}),Mt=e=>{const a=e.match(/\d+(\.\d+)?/gu)??[];return Array.from({length:3}).map((t,r)=>+(a[r]??0))},Vt=e=>{const a=e.match(/\d+(\.\d+)?/gu)??[];return Array.from({length:3}).map((t,r)=>k(+(a[r]??0),0,r?100:360))},Ot=e=>{const a=e.match(/\d+(\.\d+)?/gu)??[];return Array.from({length:3}).map((t,r)=>k(+(a[r]??0),0,255))},ce=(e,a)=>{switch(a){case"color_xy":{const t=Mt(e);return A({x:t[0],y:t[1]},"color_xy")}case"color_hs":{const t=Vt(e);return A({hue:t[0],saturation:t[1]},"color_hs")}case"color_rgb":{const t=Ot(e);return A({r:t[0],g:t[1],b:t[2]},"color_rgb")}case"hex":return A({hex:e},"hex")}},Gt="linear-gradient(to right, white, transparent)",Ut="linear-gradient(to right, rgb(255, 0, 0), rgb(255, 255, 0), rgb(0, 255, 0), rgb(0, 255, 255), rgb(0, 0, 255), rgb(255, 0, 255), rgb(255, 0, 0))",V=i.memo(({label:e,...a})=>o.jsxs("label",{className:"input",children:[e,o.jsx("input",{type:"text",className:"grow",...a})]})),Ke=i.memo(e=>{const{onChange:a,value:t={},format:r,minimal:s}=e,[n,u]=i.useState(A(t,r)),[c,f]=i.useState(Ie(n)),[l,d]=i.useState({color_rgb:!1,color_hs:!1,color_xy:!1,hex:!1});i.useEffect(()=>{const b=A(t,r);u(b),f(Ie(b))},[t,r]),i.useEffect(()=>{if(!l.color_xy){const b=Qe(n.color_xy);f(g=>({...g,color_xy:b}))}},[l.color_xy,n.color_xy]),i.useEffect(()=>{if(!l.color_hs){const b=G(n.color_hs);f(g=>({...g,color_hs:b}))}},[l.color_hs,n.color_hs]),i.useEffect(()=>{if(!l.color_rgb){const b=Ye(n.color_rgb);f(g=>({...g,color_rgb:b}))}},[l.color_rgb,n.color_rgb]),i.useEffect(()=>{if(!l.hex){const b=Je(n.hex);f(g=>({...g,hex:b}))}},[l.hex,n.hex]);const h=i.useCallback(b=>{if(b.target.value){const g=Array.from(n.color_hs);g[1]=b.target.valueAsNumber;const C=G(g);f(E=>({...E,color_hs:C})),u(ce(C,"color_hs"))}},[n.color_hs]),m=i.useCallback(b=>{if(b.target.value){const g=Array.from(n.color_hs),C=g[1];g[1]=C===0?100:C,g[0]=b.target.valueAsNumber;const E=G(g);f(_=>({..._,color_hs:E})),u(ce(E,"color_hs"))}},[n.color_hs]),p=i.useCallback(b=>{const{value:g,name:C}=b.target;f(E=>({...E,[C]:g})),u(ce(g,C))},[]),x=i.useCallback(b=>{d(g=>({...g,[b.target.name]:!0}))},[]),y=i.useCallback(b=>{d(g=>({...g,[b.target.name]:!1})),a($e(n,r))},[n,r,a]),j=i.useCallback(()=>{a($e(n,r))},[n,r,a]),N=i.useMemo(()=>`hsl(${n.color_hs[0]}, 100%, 50%)`,[n.color_hs[0]]);return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex flex-row flex-wrap gap-3 items-center",children:o.jsx("div",{className:`w-full${s?" max-w-xs":""}`,children:o.jsx("input",{type:"range",min:0,max:100,value:n.color_hs[1],className:`range [--range-bg:transparent] [--range-fill:0] w-full${s?" range-xs ":""}`,style:{backgroundImage:Gt,backgroundColor:N},onChange:h,onTouchEnd:j,onMouseUp:j})})}),o.jsx("div",{className:"flex flex-row flex-wrap gap-3 items-center",children:o.jsx("div",{className:`w-full${s?" max-w-xs":""}`,children:o.jsx("input",{type:"range",min:0,max:360,value:n.color_hs[0],className:`range [--range-bg:transparent] [--range-fill:0] w-full${s?" range-xs ":""}`,style:{backgroundImage:Ut},onChange:m,onTouchEnd:j,onMouseUp:j})})}),!s&&o.jsxs("div",{className:"flex flex-row flex-wrap gap-2 justify-around",children:[o.jsx(V,{label:"hex",name:"hex",value:c.hex,onChange:p,onFocus:x,onBlur:y}),o.jsx(V,{label:"rgb",name:"color_rgb",value:c.color_rgb,onChange:p,onFocus:x,onBlur:y}),o.jsx(V,{label:"hsv",name:"color_hs",value:c.color_hs,onChange:p,onFocus:x,onBlur:y}),o.jsx(V,{label:"xyY",name:"color_xy",value:c.color_xy,onChange:p,onFocus:x,onBlur:y})]})]})}),Ht=i.memo(e=>{const{deviceValue:a,feature:{name:t,features:r,property:s},onChange:n,minimal:u}=e,c=i.useMemo(()=>{const l={};for(const d of r){const h=Number.parseFloat(a?.[d.name]);l[d.name]=Number.isNaN(h)?0:h}return l},[a,r]),f=i.useCallback(l=>n({[s??"color"]:l}),[s,n]);return o.jsx(Ke,{onChange:f,value:c,format:t,minimal:u})}),Lt={position:[0,25,50,75,100].map(e=>({value:e,name:`${e}`})),tilt:[0,25,50,75,100].map(e=>({value:e,name:`${e}`}))},Pt=i.memo(e=>o.jsx(R,{...e,steps:Lt}));function T(e){return typeof e!="object"}const Ze=i.memo(e=>{const{onChange:a,values:t,value:r,minimal:s}=e,{t:n}=w("common"),u=i.useCallback(c=>{const f=t.find(l=>T(l)?l===c.target.value:l.value===Number.parseInt(c.target.value,10));a(f)},[t,a]);return s?o.jsxs("select",{className:"select",onChange:u,value:T(r)?r:r?.value,children:[o.jsx("option",{value:"",disabled:!0,children:n("select_value")}),t.map(c=>o.jsx("option",{value:T(c)?c:c.value,children:T(c)?c:c.name},T(c)?c:c.name))]}):o.jsx("div",{className:"join join-vertical lg:join-horizontal",children:t.map(c=>o.jsx(S,{className:`btn btn-soft btn-sm join-item${(T(c)?c===r:c.value===(T(r)?r:r?.value))?" btn-active":""}`,onClick:f=>a(f),item:T(c)?c:c.value,title:T(c)?`${c}`:c.description,children:T(c)?o.jsx(U,{value:c,name:""}):c.name},T(c)?c:c.name))})}),zt=6,Wt=i.memo(e=>{const{onChange:a,feature:{access:t=v.SET,values:r,property:s},deviceValue:n,minimal:u}=e;return t&v.SET?o.jsx(Ze,{onChange:c=>a({[s]:c}),values:r,value:n||"",minimal:u||r.length>zt}):t&v.STATE?o.jsx(q,{...e}):o.jsx($,{...e})}),Dt=i.memo(e=>o.jsx(R,{...e})),Xt=i.memo(e=>{const{minimal:a,onChange:t,feature:{length_min:r,length_max:s,property:n},deviceValue:u}=e,{t:c}=w(["gradient","common"]),[f,l]=i.useState(r>0?Array(r).fill("#ffffff"):[]);i.useEffect(()=>{u&&Array.isArray(u)&&u.length>0&&l(u)},[u]);const d=i.useCallback((b,g)=>{const C=Array.from(f);C[b]=g,l(C)},[f]),h=i.useCallback(()=>{const b=Array.from(f);b.push("#ffffff"),l(b)},[f]),m=i.useCallback(b=>{const g=Array.from(f);g.splice(b,1),l(g)},[f]),p=i.useCallback(()=>t({[n??"gradient"]:f}),[f,n,t]),[x,y]=i.useState(!1),[j,N]=i.useState(!1);return i.useEffect(()=>{y(f.length<s),N(f.length>r)},[f,r,s]),o.jsxs("div",{className:"flex flex-col gap-2",children:[f.map((b,g)=>o.jsxs("div",{className:"flex flex-row flex-wrap gap-2 items-center",children:[o.jsx(Ke,{onChange:C=>{d(g,C.hex)},value:{hex:b},format:"hex",minimal:a}),j&&o.jsx(S,{className:"btn btn-sm btn-error",onClick:()=>m(g),children:"-"})]},`${b}-${g}`)),x&&o.jsx("div",{className:"flex flex-row flex-wrap gap-2",children:o.jsx(S,{className:"btn btn-sm btn-success",onClick:h,children:"+"})}),o.jsx("div",{children:o.jsx(S,{className:`btn btn-primary ${a?"btn-sm":""}`,onClick:p,children:c("common:apply")})})]})}),Qt={brightness:[0,25,50,75,100].map(e=>({value:Zr(e,[0,100],[0,255]),name:`${e}%`})),color_temp:[1e3,2e3,3e3,4e3,5e3,6500].map(e=>({value:1e6/e,name:`${e}K`}))},Yt=i.memo(e=>o.jsx(R,{...e,steps:Qt}));function Jt(e){return e.type==="composite"&&(e.name==="color_xy"||e.name==="color_hs")}const Kt=i.memo(e=>{const{t:a}=w("zigbee"),{children:t,feature:r,deviceValue:s,onRead:n,endpointSpecific:u}=e,c=r.unit,f=i.useMemo(()=>_t(r.name,s,c),[c,r.name,s]),l=i.useMemo(()=>r.property&&r.access&v.GET||Jt(r),[r]),d=e.parentFeatures?.[e.parentFeatures.length-1],h=r.name==="state"?r.property:r.name;let m=r.label||pt(mt(h));d?.label&&r.name==="state"&&d.type!=="light"&&d.type!=="switch"&&(m=`${d.label} ${r.label.charAt(0).toLowerCase()}${r.label.slice(1)}`);const p=i.useCallback(x=>{x.property&&n?.({[x.property]:""})},[n]);return o.jsxs("div",{className:"list-row p-3",children:[o.jsx("div",{children:o.jsx(ie,{icon:f[0],fixedWidth:!0,className:f[1],...f[2],size:"2xl"})}),o.jsxs("div",{children:[o.jsxs("div",{title:h,children:[m,!u&&r.endpoint?` (${a("endpoint")}: ${r.endpoint})`:""]}),o.jsx("div",{className:"text-xs font-semibold opacity-60",children:r.description})]}),o.jsx("div",{className:"list-col-wrap flex flex-col gap-2",children:t}),l&&o.jsx(S,{item:r,onClick:p,className:"btn btn-xs btn-square btn-primary",children:o.jsx(ie,{icon:et})})]})}),Zt=i.memo(e=>{const{onChange:a,value:t,feature:r,parentFeatures:s}=e,[n,u]=i.useState(t);i.useEffect(()=>{u(t)},[t]);const c=i.useCallback(h=>{u(h),a(h)},[a]),f=i.useCallback((h,m)=>{const p=Array.from(n);typeof h=="object"&&(h={...n[m],...h}),p[m]=h,c(p)},[n,c]),l=i.useCallback(h=>{const m=Array.from(n);m.splice(h,1),c(m)},[n,c]),d=i.useCallback(()=>u([...n,{}]),[n]);return n.length===0?o.jsx("div",{className:"flex flex-row flex-wrap gap-2",children:o.jsx(S,{className:"btn btn-success col-1",onClick:d,children:"+"})}):n.map((h,m)=>o.jsxs("div",{className:"flex flex-row flex-wrap gap-2",children:[o.jsx(er,{feature:r,device:{},deviceState:h,onChange:p=>f(p,m),featureWrapperClass:Kt,parentFeatures:s}),o.jsxs("div",{className:"join join-vertical lg:join-horizontal",children:[o.jsx(S,{item:m,className:"btn btn-sm btn-error btn-square join-item",onClick:l,children:"-"}),n.length-1===m&&o.jsx(S,{className:"btn btn-sm btn-success btn-square join-item",onClick:d,children:"+"})]})]},m))}),ea=i.memo(e=>{const{t:a}=w(["list","common"]),{feature:t,minimal:r,parentFeatures:s,onChange:n,deviceValue:u}=e,[c,f]=i.useState(t.property?u?.[t.property]??[]:[]),l=i.useMemo(()=>{if(s!==void 0){if(s.length===0)return!0;if(s.length===1){const x=s[0].type;return x!=null&&x!=="composite"&&x!=="list"}}return!1},[s]),d=i.useCallback(x=>{if(f(x),!l){let y=x;if(t.item_type.type!=="composite"&&t.item_type.name){y=[];for(const j of x)y.push(j[t.item_type.name])}n(t.property?{[t.property]:y}:y)}},[t.property,t.item_type,n,l]),h=i.useCallback(()=>{let x=c;if(t.item_type.type!=="composite"&&t.item_type.name){x=[];for(const y of c)x.push(y[t.item_type.name])}n(t.property?{[t.property]:x}:x)},[t.property,t.item_type,n,c]),{access:m=v.SET,item_type:p}=t;return m&v.SET?o.jsxs(o.Fragment,{children:[o.jsx(Zt,{feature:p,parentFeatures:[...s,t],onChange:d,value:c}),l&&o.jsx("div",{children:o.jsx(S,{className:`btn btn-primary ${r?"btn-sm":""}`,onClick:h,disabled:c.length===0,children:a("common:apply")})})]}):m&v.STATE?o.jsx(q,{...e}):o.jsx($,{...e})}),ra=i.memo(e=>o.jsx(R,{...e})),ta=i.memo(e=>{const{onChange:a,value:t,min:r,max:s,unit:n,steps:u,minimal:c,...f}=e,[l,d]=i.useState(t),h=r!=null&&s!=null;i.useEffect(()=>{d(t)},[t]);const m=i.useCallback(x=>{d(x.target.value?x.target.valueAsNumber:"")},[]),p=i.useCallback(x=>!x.target.validationMessage&&a(l===""?null:l),[l,a]);return o.jsxs("div",{className:"flex flex-row flex-wrap gap-3 items-center",children:[!c&&u?o.jsx(Ze,{values:u,onChange:a,value:l}):null,h?o.jsxs("div",{className:"w-full max-w-xs",children:[o.jsx("input",{min:r,max:s,type:"range",className:"range range-xs range-primary validator",value:l,onChange:m,onTouchEnd:p,onMouseUp:p,...f}),o.jsxs("div",{className:"flex justify-between px-1 mt-1 text-xs",children:[o.jsx("span",{children:r}),c&&o.jsx("span",{children:l}),o.jsx("span",{children:s})]})]}):null,(!c||!h)&&o.jsxs("label",{className:"input",children:[o.jsx("input",{type:"number",className:"grow validator",value:l,onChange:m,onBlur:p,min:r,max:s,...f}),n]})]})}),aa=i.memo(e=>{const{feature:{presets:a,access:t=v.SET,property:r,unit:s,value_max:n,value_min:u,value_step:c},deviceValue:f,steps:l,onChange:d,minimal:h}=e;return t&v.SET?o.jsx(ta,{onChange:m=>d({[r]:m}),value:f??"",min:u,max:n,step:c,steps:a?.length?a:l,unit:s,minimal:h}):t&v.STATE?o.jsx(q,{...e}):o.jsx($,{...e})}),na=i.memo(e=>o.jsx(R,{...e})),sa=i.memo(e=>{const{onChange:a,value:t,...r}=e,[s,n]=i.useState(t);return i.useEffect(()=>{n(t)},[t]),o.jsx("input",{type:"text",className:"input validator",value:s,onChange:u=>n(u.target.value),onBlur:u=>!u.target.validationMessage&&a(s),...r})}),oa=i.memo(e=>{const{feature:{access:a=v.SET,property:t},deviceValue:r,onChange:s}=e;return a&v.SET?o.jsx(sa,{onChange:n=>s({[t]:n}),value:r??""}):a&v.STATE?o.jsx(q,{...e}):o.jsx($,{...e})}),er=i.memo(e=>{const{feature:a,device:t,deviceState:r,steps:s,onRead:n,onChange:u,featureWrapperClass:c,minimal:f,endpointSpecific:l,parentFeatures:d}=e,h=i.useMemo(()=>a.property?r[a.property]:void 0,[a.property,r[a.property]]),m=i.useMemo(()=>He(a),[a]),p=i.useMemo(()=>({device:t,deviceValue:h,onChange:u,onRead:n,featureWrapperClass:c,minimal:f,endpointSpecific:l,parentFeatures:d}),[t,h,u,n,c,f,l,d]),x=i.useMemo(()=>({feature:a,onRead:n,deviceValue:h,parentFeatures:d,endpointSpecific:l}),[a,n,h,d,l]);switch(a.type){case"binary":return o.jsx(c,{...x,children:o.jsx(yt,{feature:a,...p},m)},m);case"numeric":return o.jsx(c,{...x,children:o.jsx(aa,{feature:a,...p,steps:s},m)},m);case"list":return a.name==="gradient"&&a.length_min!=null&&a.length_max!=null?o.jsx(c,{...x,children:o.jsx(Xt,{feature:a,...p},m)},m):o.jsx(c,{...x,children:o.jsx(ea,{feature:a,...p},m)},m);case"text":return o.jsx(c,{...x,children:o.jsx(oa,{feature:a,...p},m)},m);case"enum":return o.jsx(c,{...x,children:o.jsx(Wt,{feature:a,...p},m)},m);case"light":return o.jsx(Yt,{feature:a,...p,deviceState:r},m);case"switch":return o.jsx(na,{feature:a,...p,deviceState:r},m);case"cover":return o.jsx(Pt,{feature:a,...p,deviceState:r},m);case"lock":return o.jsx(ra,{feature:a,...p,deviceState:r},m);case"climate":return o.jsx(Ct,{feature:a,...p,deviceState:r},m);case"fan":return o.jsx(Dt,{feature:a,...p,deviceState:r},m);case"composite":{if(a.name==="color_xy"||a.name==="color_hs")return o.jsx(c,{...x,children:o.jsx(Ht,{feature:a,...p},m)},m);const y=d&&a.property?r[a.property]:r;return o.jsx(c,{...x,children:o.jsx(R,{feature:a,...p,deviceState:y},m)},m)}default:return console.error("Unsupported feature",a),o.jsx(c,{...x,children:o.jsx("pre",{children:JSON.stringify(a,null,4)})},m)}});export{er as F,Kt as a,v as b,_t as c,mt as d,He as g,pt as s};

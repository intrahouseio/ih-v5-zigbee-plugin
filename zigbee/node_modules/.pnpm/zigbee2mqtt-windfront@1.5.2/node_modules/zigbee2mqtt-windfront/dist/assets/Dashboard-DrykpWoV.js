import{a as v,r as c,W as N,b as S,s as _,v as D,w as C,j as e,B as x,x as F,F as g,y as T,f as R,z as k,A as L,C as I}from"./index-B9KSRkAy.js";import{D as M}from"./DashboardFeatureWrapper-BV-EJkYu.js";import{D as q}from"./DeviceCard-BibgHF2R.js";import{D as B,R as $}from"./DeviceControlEditName-CW6kAJai.js";import{D as W}from"./DebouncedInput-BbusN73N.js";import"./envs-DFlyG_dH.js";import"./Feature-DRiBEd30.js";import"./DisplayValue-DKwqD83w.js";import"./_createCompounder-Db7SjIIq.js";import"./LastSeen-kmLjgf_4.js";import"./format-CsVfcRLB.js";import"./Lqi-BZ7lW9bx.js";import"./PowerSource-DgbKMgpx.js";import"./snakeCase-BsE9z82R.js";import"./DeviceImage-XiUg0NFS.js";import"./index-DajxErfA.js";import"./CheckboxField-DnsgrtmM.js";import"./InputField-D8fYIAZ2.js";const K=["schedule_","_mode","_options","_startup","_type","inching_","cyclic_"],U=["battery","linkquality","options","position","programming","strength","voltage","warning","gradient","power_outage_memory","power_on_behavior"],z=["state","brightness","color_temp","mode","sound","occupancy","tamper","alarm","action","contact"],H=(a,i)=>{if(a){if(z.includes(a))return!0;for(const l of K)if(a.includes(l))return!1;if(U.includes(a))return!1}return!0},E=(a,i={})=>{const{property:l,name:o,access:d}=a;if(H(o)){if("features"in a&&a.features&&a.features.length>0){const n=[],f=l?i[l]:i;for(const r of a.features){const u=E(r,f);u&&!n.some(b=>b.property===u.property)&&n.push(u)}return{...a,features:n}}return{...a}}};function le(){const a=v(s=>s.deviceStates),i=v(s=>s.bridgeInfo.config),l=v(s=>s.devices),{sendMessage:o}=c.useContext(N),{t:d}=S(["zigbee","settings"]),[n,f]=c.useState(_.get(D,"")),[r,u]=c.useState(_.get(C,!1));c.useEffect(()=>{_.set(D,n)},[n]);const b=c.useCallback(async(s,t,m)=>{await o("bridge/request/device/rename",{from:s,to:t,homeassistant_rename:m,last:!1})},[o]),j=c.useCallback(async(s,t,m)=>{await o("bridge/request/device/remove",{id:s,force:t,block:m})},[o]),w=c.useCallback(s=>{_.set(C,s),u(s)},[]),A=c.useMemo(()=>{const s=[];for(const t of l)if(!t.disabled&&t.supported&&(!n||t.friendly_name.toLowerCase().includes(n.toLowerCase()))){const m=a[t.friendly_name]??{},h=[];if(t.definition?.exposes)for(const p of t.definition.exposes){const y=E(p,m);if(y&&(h.push(y),h.length===10))break}h.length>0&&s.push(e.jsx("div",{className:`${r?"break-inside-avoid-column mb-3":"w-[23rem]"} card bg-base-200 rounded-box shadow-md`,children:e.jsx(q,{features:h,device:t,deviceState:m,onChange:async p=>await o(`${t.ieee_address}/set`,p),onRead:async p=>await o(`${t.ieee_address}/get`,p),featureWrapperClass:M,lastSeenConfig:i.advanced.last_seen,children:e.jsxs("div",{className:"join join-horizontal",children:[e.jsx(B,{name:t.friendly_name,renameDevice:b,homeassistantEnabled:i.homeassistant.enabled,style:"btn-outline btn-primary btn-square btn-sm join-item"}),e.jsx(x,{onClick:async()=>await F.show($,{device:t,removeDevice:j}),className:"btn btn-outline btn-error btn-square btn-sm join-item",title:d("remove_device"),children:e.jsx(g,{icon:T})})]})})},t.ieee_address))}return s},[l,a,i.advanced.last_seen,i.homeassistant.enabled,o,j,b,d,n,r]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-row justify-center items-center gap-3 mb-3",children:[e.jsxs("div",{className:"join",children:[e.jsxs("label",{className:"input w-64 join-item",children:[e.jsx(g,{icon:R}),e.jsx(W,{className:"",type:"search",onChange:s=>f(s.toString()),placeholder:d("common:search"),value:n})]}),e.jsx(x,{item:"",onClick:f,className:"btn btn-square join-item",title:d("common:clear"),children:e.jsx(g,{icon:k})})]}),e.jsx(x,{className:"btn btn-square",item:!r,onClick:w,title:`${d("settings:dashboard_column_display")}: ${r}`,children:e.jsx(g,{icon:r?L:I})})]}),e.jsx("div",{className:`${r?"columns-md":"flex flex-row flex-wrap justify-center"} gap-3 mb-3`,children:A})]})}export{le as default};
